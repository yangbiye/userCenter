# 用户中心项目

## 总体流程

1. 后端初始化
   1. 准备环境（mysql5.7,Java8）,连接数据库
   2. 初始化后端项目，整合框架
2. 数据库设计
3. 登录/注册
   1. 后端 20mins
      1. 整合项目目录
      2. 实现基本数据库操作
         1. user->mybatisX自动生成
      3. 写登录逻辑
4. 用户管理（仅管理员）20mins



## 数据库设计

### 用户表

id(主键) bigint

username 昵称 varchar

userAccount 账号 varchar

avatarUrl 头像 varchar

gender 性别 tinyint

userPassword 密码 varchar

phone 电话 varchar

email 邮箱 varchar

userStatus 用户状态 int  0 -正常

固定属性：

createTime 创建时间 datatime

updateTime 更新时间 datatime

isDelete 是否删除（逻辑删除:所有操作均不是真删除，防止不可回溯）tinyint

## 注册

### 注册逻辑

1. 用户在前端输入账号和密码以及校验密码
2. 校验用户的账户、密码、校验密码、是否符合要求
   1. 非空
   2. 账户不小于四位
   3. 密码不小于八位
   4. 账户不能重复
   5. 账户不能包含特殊字符
   6. 密码和校验密码相同
3. 加密密码
4. 将数据插入数据库

## 登录

### 登录接口

请求参数：用户账户，密码

请求类型：POST

请求体：JSON格式

	- 请求参数很长不建议用get

返回值：用户信息（脱敏）

### 逻辑

1. 校验账户密码是否合法
   1. 非空
   2. 账户不小于四位
   3. 密码不小于八位
   4. 账户不含特殊字符
2. 校验密码是否输入正确，要和数据库中的密文密码去比对
3. 用户信息脱敏，防止数据库字段泄露
4. 记录用户的登录态（session）。存在服务器上（用后端springboot封装的服务器tomcat去记录）cookie
5. 返回脱敏用户信息

### 如何知道是那个用户登录成功了

1. 连接到服务器端后，得到一个session状态（匿名会话），返回给前端

2. 登录成功后，得到登录成功的session，并且给该session设置一些值（比用户信息），返回给前端一个设置cookie的命令
3. 前端接收到后端的命令后，设置cookie，保存到浏览器
4. 前端再次请求后端的时候（相同的域名），在请求头中带上cookie去请求
5. 后端拿到前端传来的cookie，找到对应的session
6. 后端从session中可以取出基于该session存储的变量（用户的登录信息，登录名）



## 控制层Controlller封装请求

controller层倾向于对请求参数本身的校验，不涉及业务逻辑的本身

service层是对业务逻辑的校验（有可能被controller之外的类调用）

## 用户管理

### 用户管理接口

必须鉴权！！

1. 查询用户
   1. 允许根据用户名查询
2. 删除用户



## 写代码流程

先做设计

代码实现

持续优化！！！（复用代码，提取公共逻辑/常量）